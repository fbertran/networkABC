<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using the networkABC package • networkABC</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using the networkABC package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">networkABC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vignette.html">Using the networkABC package</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fbertran/networkABC/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using the networkABC package</h1>
                        <h4 data-toc-skip class="author">Frédéric
Bertrand, Nicolas Jung, Myriam Maumy-Bertrand</h4>
            
            <h4 data-toc-skip class="date">2025-08-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/fbertran/networkABC/blob/HEAD/vignettes/vignette.Rmd" class="external-link"><code>vignettes/vignette.Rmd</code></a></small>
      <div class="d-none name"><code>vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>Elucidating gene regulatory network is an important step towards
under- standing the normal cell physiology and complex pathological
phenotype. Reverse- engineering consists in using gene expression over
time or over different experimental conditions to discover the structure
of the gene network in a targeted cellular process. The fact that gene
expression data are usually noisy, highly correlated, and have high
dimensionality explains the need for specific statistical methods to
reverse engineer the underlying network. Among known methods,
Approximate Bayesian Computation (ABC) algorithms have not been very
well studied. Due to the computational overhead their application is
also limited to a small number of genes. In this work we have developed
a new multi-level ABC approach that has less computational cost. At the
first level, the method captures the global properties of the network,
such as scale-freeness and cluster- ing coefficients, whereas the second
level is targeted to capture local properties, including the probability
of each couple of genes being linked.</p>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<div class="float">
<img src="grapheABC.png" width="800" alt="Steps of the network ABC package."><div class="figcaption">Steps of the network ABC package.</div>
</div>
</div>
<div class="section level2">
<h2 id="generation-of-a-network-topology">Generation of a network topology<a class="anchor" aria-label="anchor" href="#generation-of-a-network-topology"></a>
</h2>
<p>Load the <code>networkABC</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/networkABC/">networkABC</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="examples-and-checks">Examples and checks<a class="anchor" aria-label="anchor" href="#examples-and-checks"></a>
</h3>
<p>To generate a network, the number of node and the targeted clustering
coefficient should be specified. For example, the following produces a
network with 100 nodes and a targeted clustering coefficient of 0.33
:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/network_gen.html">network_gen</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0.33</span><span class="op">)</span></span></code></pre></div>
<p>Then, we can plot the network :</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://statnet.org/" class="external-link">network</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: network</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 'network' 1.19.0 (2024-12-08), part of the Statnet Project</span></span>
<span><span class="co">#&gt; * 'news(package="network")' for changes since last version</span></span>
<span><span class="co">#&gt; * 'citation("network")' for citation information</span></span>
<span><span class="co">#&gt; * 'https://statnet.org' for help, support, and other information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/network/man/network.html" class="external-link">network</a></span><span class="op">(</span><span class="va">net</span><span class="op">$</span><span class="va">network</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>Here is a simulation to show that the algorithm produces networks
with a clustering coefficient close to the targeted one</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">a</span><span class="op">&lt;-</span><span class="va">a</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We generate 500 networks with 500 nodes with a targeted clustering
coefficient of 0.33</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">clco</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">N</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/network_gen.html">network_gen</a></span><span class="op">(</span><span class="fl">500</span>,<span class="fl">.33</span><span class="op">)</span><span class="op">$</span><span class="va">net</span></span>
<span>  <span class="va">N</span><span class="op">&lt;-</span><span class="va">N</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span>  <span class="va">clco</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu">networkABC</span><span class="fu">::</span><span class="fu"><a href="../reference/clusteringCoefficient.html">clusteringCoefficient</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Here is the result :</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">clco</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3306789</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">clco</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.02874285</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html" class="external-link">qplot</a></span><span class="op">(</span><span class="va">clco</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `qplot()` was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>Notice that the algorithm cannot reach all desired values of
clustering coefficients, because the network has to be scalefree.</p>
<p>For example, a clustering coefficient of 1 implies that every couple
of nodes are linked together ; such a network is obviously not
scale-free.</p>
</div>
<div class="section level3">
<h3 id="details-about-the-algorithm">Details about the algorithm<a class="anchor" aria-label="anchor" href="#details-about-the-algorithm"></a>
</h3>
<p>This algorithm is partially based on the algorithm by Di Camillo,
Barbara, Gianna Toffolo, and Claudio Cobelli. ”A gene network simulator
to assess reverse engineering algorithms.” <em>Annals of the New York
Academy of Sciences</em>.</p>
<p>Let us call
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
the set of nodes to be connected in the graph
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
at the current iteration
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
the set of nodes to be connected at iteration
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t + 1</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
is initialized as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>N</mi></mrow></mrow><annotation encoding="application/x-tex">V = {1, ...,N}</annotation></semantics></math>,
that is, with all the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
nodes in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>,
whereas
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
is initialized as the empty set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>.
Nodes are then linked to each other through an iterative procedure,
which consists of three main steps, explained in detail below. 1. Three
candidate modules are generated. The structure is sampled from a pool of
motifs, with possibility of random changes. The number of node of the
module is set at random. In this algorithm we have : feedback motif,
feedforward motifs and loops. 2. A score is assigned to each module, and
one of the three modules is sampled with probability proportional to
this score; let us denote the sampled module by M and the number of its
nodes by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>.
3.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
nodes are sampled from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
and linked to each other in the graph
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>,
according to the selected module structure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
is updated by deleting the m sampled nodes;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
is updated by adding the nodes. At the end of this process,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
is empty whereas
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
is composed of a lot of motifs. To link the motifs together, we have to
choose one node in each motif that is the first position. This set of
nodes is then considered as set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
.</p>
</div>
</div>
<div class="section level2">
<h2 id="running-the-abc-algorithm">Running the ABC algorithm<a class="anchor" aria-label="anchor" href="#running-the-abc-algorithm"></a>
</h2>
<div class="section level3">
<h3 id="the-simpliest-way">The simpliest way<a class="anchor" aria-label="anchor" href="#the-simpliest-way"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">M</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>,<span class="fl">10</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/abc.html">abc</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; First run of abc to find tolerance</span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Iteration=1</span></span>
<span><span class="co">#&gt; Accepted:1000</span></span>
<span><span class="co">#&gt; Probabilities of clustering coefficients:</span></span>
<span><span class="co">#&gt; 0.325000 0.349000 0.326000 </span></span>
<span><span class="co">#&gt; Tolerance value</span></span>
<span><span class="co">#&gt;       5% </span></span>
<span><span class="co">#&gt; 4.523488 </span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Beginning main run of abc</span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Iteration=1</span></span>
<span><span class="co">#&gt; Accepted:45</span></span>
<span><span class="co">#&gt; Probabilities of clustering coefficients:</span></span>
<span><span class="co">#&gt; 0.488889 0.311111 0.200000 </span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Iteration=2</span></span>
<span><span class="co">#&gt; Accepted:109</span></span>
<span><span class="co">#&gt; Probabilities of clustering coefficients:</span></span>
<span><span class="co">#&gt; 0.522936 0.266055 0.211009 </span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Iteration=3</span></span>
<span><span class="co">#&gt; Accepted:139</span></span>
<span><span class="co">#&gt; Probabilities of clustering coefficients:</span></span>
<span><span class="co">#&gt; 0.654676 0.201439 0.143885 </span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Iteration=4</span></span>
<span><span class="co">#&gt; Accepted:163</span></span>
<span><span class="co">#&gt; Probabilities of clustering coefficients:</span></span>
<span><span class="co">#&gt; 0.705521 0.196319 0.098160 </span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Iteration=5</span></span>
<span><span class="co">#&gt; Accepted:154</span></span>
<span><span class="co">#&gt; Probabilities of clustering coefficients:</span></span>
<span><span class="co">#&gt; 0.753247 0.181818 0.064935 </span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Iteration=6</span></span>
<span><span class="co">#&gt; Accepted:210</span></span>
<span><span class="co">#&gt; Probabilities of clustering coefficients:</span></span>
<span><span class="co">#&gt; 0.819048 0.142857 0.038095 </span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Iteration=7</span></span>
<span><span class="co">#&gt; Accepted:200</span></span>
<span><span class="co">#&gt; Probabilities of clustering coefficients:</span></span>
<span><span class="co">#&gt; 0.860000 0.120000 0.020000 </span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Iteration=8</span></span>
<span><span class="co">#&gt; Accepted:163</span></span>
<span><span class="co">#&gt; Probabilities of clustering coefficients:</span></span>
<span><span class="co">#&gt; 0.865031 0.110429 0.024540 </span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Iteration=9</span></span>
<span><span class="co">#&gt; Accepted:232</span></span>
<span><span class="co">#&gt; Probabilities of clustering coefficients:</span></span>
<span><span class="co">#&gt; 0.909483 0.077586 0.012931 </span></span>
<span><span class="co">#&gt; ===============================</span></span>
<span><span class="co">#&gt; Iteration=10</span></span>
<span><span class="co">#&gt; Accepted:238</span></span>
<span><span class="co">#&gt; Probabilities of clustering coefficients:</span></span>
<span><span class="co">#&gt; 0.907563 0.079832 0.012605</span></span></code></pre></div>
<p>We can plot the results in three different ways :</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">networkABC</span><span class="fu">::</span><span class="fu"><a href="../reference/showHp.html">showHp</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<pre><code><span><span class="co">#&gt;   gene.hubs hubs.proba</span></span>
<span><span class="co">#&gt; 1         4  0.2282913</span></span>
<span><span class="co">#&gt; 2         5  0.2394958</span></span>
<span><span class="co">#&gt; 3        10  0.2521008</span></span></code></pre>
<p>This plot show the probabilities for each gene of being a hub. The
following shows the probability for each couple of genes of being linked
:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/showNp.html">showNp</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-11-1.png" width="768">
Specifying a probability cutoff (the minimal probability for which we
can say that two genes are linked), we can plot the network :</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/showNetwork.html">showNetwork</a></span><span class="op">(</span><span class="va">result</span>,<span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<p>In this plot, the diameter of a node increases with the number of its
children whereas the color is a function of the probability for each
gene of being a hub.</p>
<p>You can also have a look on the error :</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="using-abc-algorithm-with-full-options">Using ABC algorithm with full options<a class="anchor" aria-label="anchor" href="#using-abc-algorithm-with-full-options"></a>
</h3>
<p>You can specify all the arguments of the ABC function: more details
in the help manual.</p>
<p>For example :</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/abc.html">abc</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">M</span>,</span>
<span>            clust_coeffs<span class="op">=</span><span class="fl">0.33</span>, <span class="co">#you can specify more than one clustering coefficient</span></span>
<span>            tolerance<span class="op">=</span><span class="fl">3.5</span>, <span class="co">#maximal distance between simulated and real data</span></span>
<span>            <span class="co"># to accept the network</span></span>
<span>            number_hubs<span class="op">=</span><span class="fl">3</span>,<span class="co">#the number of hubs</span></span>
<span>            iterations<span class="op">=</span><span class="fl">10</span>, <span class="co">#number of iterations</span></span>
<span>            number_networks<span class="op">=</span><span class="fl">1000000</span>,<span class="co">#number of network simulated at each iteration</span></span>
<span>            hub_probs<span class="op">=</span><span class="cn">NA</span>,<span class="co">#specify the a priori probabilty for each gene to be a hub</span></span>
<span>            neighbour_probs<span class="op">=</span><span class="cn">NA</span>,<span class="co">#specify the a priori probability for each couple</span></span>
<span>            <span class="co">#of gene to be linked</span></span>
<span>            is_probs<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="co">#set this last option to one.</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Frederic Bertrand, Myriam Maumy-Bertrand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
